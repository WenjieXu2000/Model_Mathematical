# 空间插值

## 基本概念

1. **定义**：空间插值常用于将**离散**的测量数据转换为**连续**的数据曲面，以便与其它空间现象的分布模式进行比较，它包括了空间内插和外推两种算法。
   - 空间内插算法：通过**已知点**的数据推求同一区域未知点数据
   - 空间外推算法：通过**已知区域**的数据，推求**其它区域**数据
2. 插值分类
   - 整体插值、局部插值和边界内插法
   - 确定性插值和地统计插值
   - 精确插值和近似插值

## 插值方法

### 整体插值

1. 原理：用研究区所有采样点数据进行全区特征拟合，整个区域的数据都会影响单个插值点，单个数据点变量值的增加、减少或者删除，都对整个区域有影响。
2. 典型方法：**全局趋势面分析 、Fourier Series（周期序列）**
3. 需注意的问题：
   - 整体插值方法将小尺度的、局部的变化看作随机和非结构性噪声，从而丢失了这一部分信息。局部插值方法恰好能弥补整体插值方法的缺陷。
   - 整体插值方法通常不直接用于空间插值，而是用来检测总趋势和不同于总趋势的最大偏离部分，即剩余部分，在去除了宏观趋势后，可用剩余残差来进行局部插值。
   - 整体插值方法通常使用方差分析和回归方程等标准的统计方法，计算比较简单。其他的许多方法也可用于整体空间插值，如傅里叶级数和小波变换，特别是遥感影像分析方面，但它们需要的数据量大。

### 局部内插法

1. 原理：只使用**邻近的数据点**来估计未知点的值，单个数据点的改变只影响其周围有限的数据点。 
   - 定义一个邻域或搜索范围
   - 搜索落在此邻域范围的数据点
   - 选择能表达这有限个点空间变化的数学函数
   - 为未知的数据点赋值
2. 典型方法：**样条函数插值法**、距离倒数插值、**Kriging插值（空间自由协方差最佳内插）**

### 边界内插法

1. 原理：假定任何重要的变化都发生在区域的边界上，边界内的变化则是均匀的、同质的。
2. 典型方法：景观单元法、Thiessen多边形法、网格像元法

### 确定性方法

1. 原理：使用**数学函数**进行插值，以研究区域内部的相似性（如反距离加权插值法），或者以平滑度为基础（如径向基函数插值法）由已知样点来创建预测表面的插值方法。
2. 主要方法：**全局多项式插值**、反距离权插值、径向基插值、局部多项式插值

### 地统计学插值

1. 原理：基于自相关性 (测量点的统计关系)，根据测量数据的统计特征产生曲面。
   - **克里格方法**依赖于数学模型和统计模型，正是由于引入了包括概率模型在内的统计模型，使克里格方法**与确定性插值方法区分开**来。
   - 在克里格方法中预测的结果将与概率联系在一起，即用克里格方法进行插值，一方面能生成预测表面，一方面能给出预测值的误差。
   - 由于建立在统计学的基础上，因此不仅可以产生预测曲面，而且可以产生误差和不确定性曲面，用来评估预测结果的好坏
2. 主要方法：多种 kriging 方法

### 精确和近似插值

1. 精确插值：产生通过所有观测点的曲面.
   - 在精确插值中，插值点落在观测点上，内插值等于估计值。
2. 近似插值：插值产生的曲面不通过所有观测点。
   - 当数据存在**不确定性**时，应该使用近似插值，由于估计值替代了已知变量值，近似插值可以平滑采样误差

## 一般插值过程
1. 选择内插方法（模型）
2. 空间数据的探索性分析，包括对数据的均值、方差、协方差、独立性和变异函数的估计等
3. 进行内插
4. 内插结果评价
5. 重新选择内插方法，直到合理
6. 内插生成最后结果

## 插值方法选择的原则
1. 精确性
2. 参数的敏感性：许多的插值方法都涉及到一个或多个参数，如距离反比法中距离的阶数等。有些方法对参数的选择相当敏感，而有些方法对变量值敏感。后者对不同的数据集会有截然不同的插值结果。**找到对参数的波动相对稳定，其值不过多地依赖变量值的插值方法。**
3. 耗时：一般情况下，计算时间不是很重要，除非特别费时。 
4. 存储要求：同耗时一样，存储要求不是决定性的。特别是在计算机的主频日益提高，内存和硬盘越来越大的情况下，二者都不需特别看重。
5. 可视化、可操作性（插值软件选择）：三维的透视图等

## 插值验证
1. 交叉验证（cross－validation）：首先假定每一测点的要素值未知，而采用周围样点的值来估算，然后计算所有样点实际观测值与内插值的误差，以此来评判估值方法的优劣。 各种插值方法得到的插值结果与样本点数据比较。
2. 实际验证：将部分已知变量值的样本点作为“训练数据集”，用于插值计算；另一部分样点 “验证数据集”，该部分站点不参加插值计算。然后利用“训练数据集” 样点进行内插，插值结果与“训练数据集”验证样点的观测值对比，比较插值的效果。 

## 常用插值算法
1. 最近邻法(Nearest Neighbor)
2. 算术平均值(Arithmetic Mean)
3. 距离反比法(Inverse Distance)
4. 高次曲面插值(Multiquadric)
5. 趋势面插值(Polynomial)
6. 最优插值(Optimal)
7. 样条插值(Spline Surface) 
8. 径向基函数插值(Radial Basis Functions)
9. 克里金插值(Kriging)
10. 最小曲率 (Minimum Curvature)