# 2012数学建模A题：葡萄酒的评价

## 问题与背景

确定葡萄酒质量时一般是通过聘请一批有资质的评酒员进行品评。每个评酒员在对葡萄酒进行品尝后对其分类指标打分，然后求和得到其总分，从而确定葡萄酒的质量。酿酒葡萄的好坏与所酿葡萄酒的质量有直接的关系，葡萄酒和酿酒葡萄检测的理化指标会在一定程度上反映葡萄酒和葡萄的质量。附件1给出了某一年份一些葡萄酒的评价结果，附件2和附件3分别给出了该年份这些葡萄酒的和酿酒葡萄的成分数据。请尝试建立数学模型讨论下列问题：

1. 分析附件1中两组评酒员的评价结果有无显著性差异，哪一组结果更可信？

2. 根据酿酒葡萄的理化指标和葡萄酒的质量对这些酿酒葡萄进行分级。
3. 分析酿酒葡萄与葡萄酒的理化指标之间的联系。
4. 分析酿酒葡萄和葡萄酒的理化指标对葡萄酒质量的影响，并论证能否用葡萄和葡萄酒的理化指标来评价葡萄酒的质量？

## 数据修正

- 第一组红葡萄酒样20，评酒员4号中缺色调数据，经计算应为6；
- 第一组白葡萄酒样3，7号评酒员的持久性超上限，应从77改为7；
- 第一组白葡萄酒样8，9号评酒员的持久性超上限，应从16改为6；
- 酿酒白葡萄的百粒质量第三组数据过大，应从2226.1改为226.1；

## 题目相关背景

1. 葡萄酒的质量
   - “七分原料、三分酿造”；
   - 优质葡萄酒是酸度、香气、风味等的平衡，葡萄果实中糖、酸决定葡萄酒的酒度、味感，丹宁、总酚、芳香物质、花色素苷等决定葡萄酒的结构、香气、外观等质量特征；
   - 单宁和色素对红葡萄酒的特色和风味作用也是显著的。单宁是很好的抗氧化物质，它的涩味和收敛感又造就了葡萄酒丰富的厚重品质。葡萄酒的颜色来源于葡萄中的色素。葡萄的色素则决定着红葡萄酒的颜色气质。
   - 芳香物质是造就葡萄酒风味的物质之一，芳香物质越多，葡萄酒的风味就浓厚。
2. GB15037-2006葡萄酒感观分类评述描述
   - 优级品：90分以上具有该产品应有的色泽，自然、悦目、澄清（透明）、有光泽；具有纯正、浓郁、优雅和谐的果香（酒香），诸香协调，口感细腻、舒顺、酒体丰满、完整、回味绵长、具该产品应有的怡人的风格。
   - 优良品：80～89分具有该产品的色泽；澄清透明，无明显悬浮物，具有纯正和谐的果香（酒香），无异香，浓郁度稍差，口感纯正，较舒顺，完整，欠优雅，回味较长，具良好的风格。
   - 合格品：70～79分与该产品应有的色泽略有不同，缺少自然感，允许有少量沉淀，具有该产品应有的气味，无异味，口感尚平衡，欠协调、完整，无明显缺陷。
   - 不合格品：65～69分与该产品应有的色泽明显不符，严重失光或浑浊，有明显异香、异味，酒体寡淡、不协调，或有其他明显的缺陷。（除色泽外，只要有其中一条，则判为不合格品。）
   - 劣质品：55～64分不具备应有的特征。

## 问题1

### 分析

- **问题**：分析附件1中两组评酒员的评价结果有无显著性差异，哪一组结果更可信？
- **评阅要点**：附件1中给出的是评酒员对27种红葡萄酒和28种白葡萄酒的两组品评结果。这两组评酒员各不相同，两组中的每个酒样都取自相同葡萄酒厂家的同一批次的产品。要求学生给出判断这两组评价结果好坏的原理、模型和方法，给出具体的结果，并对结果进行说明。**好的品评结果应该是对同一酒样评价时这些评酒员之间的差距小、且这些酒样之间的区分度明确**（注：一些学生的模型和方法仅考虑评酒员的打分差距）。参考：红酒中样品23是好酒，样品12是较差的酒。
- **参考结论**：两组评价结果有显著性差异；红酒第一组评价结果好，白酒第二组评价结果好。

### 解答

#### 第一小问：有无显著性差异

- **方法**：方差分析，t检验，F检验，秩和检验，Wilcoxon 符号秩检验，构造一些统计量，计算它们的值，是否通过检验，给出结果。

1. 评酒员对每一个酒样均从四大方面进行了评分。根据题意，**葡萄酒的质量由总分所确定**。故将每位评酒员对每种酒样品的各项评分求和得到总分，然后将同组中每种酒样品的10 个总分取平均值，从而得到第一组对27种红葡萄酒样品、28种白葡萄酒样品的综合平均评分，和第二组对27种红葡萄酒样品、28种白葡萄酒样品的综合平均评分。

   |        | 红葡萄酒   |            |        | 白葡萄酒   |            |
   | ------ | ---------- | ---------- | ------ | ---------- | ---------- |
   | 酒样品 | 第一组评分 | 第二组评分 | 酒样品 | 第一组评分 | 第二组评分 |
   | 1      | 62.7       | 68.1       | 1      | 82         | 77.9       |
   | 2      | 80.3       | 74         | 2      | 74.2       | 75.8       |
   | 3      | 80.4       | 74.6       | 3      | 85.3       | 75.6       |
   | 4      | 68.6       | 71.2       | 4      | 79.4       | 76.9       |
   | ...    | ...        | ...        | ...    | ...        | ...        |
   | 26     | 73.8       | 72         | 26     | 81.3       | 74.3       |
   | 27     | 73         | 71.5       | 27     | 64.8       | 77         |
   |        |            |            | 28     | 81.3       | 79.6       |

2.  **参数检验**需要已知总体分布类型，对未知参数进行统计推断，依赖于特定分布类型，比较的是参数 。而**非参数检验**对总体的分布类型不作严格要求，不受分布类型的影响，比较的是总体分布位置。因此，本文针对红葡萄酒和白葡萄酒的两组评分结果，对其进行**非参数检验**。

   ```python
   from scipy import stats
   """
   Shapior-wilk检验主要应用于小样本(3<n<50)的情况;
   H0: 该变量服从正态分布,H1: 该变量不服从正态分布;
   """
   shapiro_test = stats.shapiro(data_1['第一组评分'])
   print("Shapiro wilk Test Statstic:{}   Pvalue:{}".format(shapiro_test.statistic,shapiro_test.pvalue))
   shapiro_test = stats.shapiro(data_1['第二组评分'])
   print("Shapiro wilk Test Statstic:{}   Pvalue:{}".format(shapiro_test.statistic,shapiro_test.pvalue))
   shapiro_test = stats.shapiro(data_2['第一组评分'])
   print("Shapiro wilk Test Statstic:{}   Pvalue:{}".format(shapiro_test.statistic,shapiro_test.pvalue))
   shapiro_test = stats.shapiro(data_2['第二组评分'])
   print("Shapiro wilk Test Statstic:{}   Pvalue:{}".format(shapiro_test.statistic,shapiro_test.pvalue))
   ```

   

#### 第二小问-哪一组结果更可

1. **方法：**比较方差大小，Cronbach可信度系数，比较酒样F值和评酒员F值的相对大小，Spearman秩相关系数，肯德尔和谐系数法。
