function [ERI,ESI,SHI,FCI_result] = FCI(data,ind)
% FCI综合指标脆弱性指数

% 计算归一化矩阵
[~,m]=size(data); % n个样本, m个指标
for i=1:m
    if ind(i)==1 %正向指标归一化
        Y(:,i)=MinMaxNormalized(data(:,i),1,0.0001,0.9999);   
    else %负向指标归一化
        Y(:,i)=MinMaxNormalized(data(:,i),2,0.0001,0.9999);
    end
end

w1 = [0.531365173478108,0.256948436548204,0.211686389973688];
w2 = [0.251158477169790,0.295863552219905,0.220220280487242,0.232757690123062];
w3 = [0.182896789097924,0.207919948822887,0.192265056196539,0.275895964420725,0.141022241461926];
ERI = w1(1)*Y(:,1) + w1(2)*Y(:,2) + w1(3)*Y(:,3);
ESI = w2(1)*Y(:,4) + w2(2)*Y(:,5) + w2(3)*Y(:,6) + w2(4)*Y(:,7);
SHI = w3(1)*Y(:,8) + w3(2)*Y(:,9) + w3(3)*Y(:,10) +w3(4)*Y(:,11) + w3(5)*Y(:,12);
W = [0.436050438972435,0.369768065582622,0.194181495444943];
FCI_result = W(1)*ERI + W(2)*ESI + W(3)*SHI;
end